<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ AI –†–µ–≤—å—é</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container mt-5">
        <h1 class="mb-4">ü§ñ –ò—Å—Ç–æ—Ä–∏—è —Ä–µ–≤—å—é –∫–æ–¥–∞</h1>

        <div class="card shadow-sm">
            <div class="card-body">
                {% if reports %}
                <table class="table table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>–ü—Ä–æ–µ–∫—Ç / –§–∞–π–ª</th>
                            <th>–¢–∏–ø</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–∞—Ç–∞</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for report in reports %}
                        <tr>
                            <td>{{ report.id }}</td>
                            <td>
                                <strong>{{ report.project_name }}</strong><br>
                                <small class="text-muted">{{ report.file_path }}</small>
                            </td>
                            <td>
                                <span class="badge bg-info">{{ report.content_type }}</span>
                            </td>
                            <td>
                                {% if report.status == 'completed' %}
                                    <span class="badge bg-success">–ì–æ—Ç–æ–≤–æ</span>
                                {% else %}
                                    <span class="badge bg-warning">{{ report.status }}</span>
                                {% endif %}
                            </td>
                            <td>{{ report.created_at|date:"d.m.Y H:i" }}</td>
                            <td>
                                <button class="btn btn-sm btn-outline-primary" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ report.id }}">
                                    –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç—á–µ—Ç
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="6" class="border-0 p-0">
                                <div class="collapse" id="collapse{{ report.id }}">
                                    <div class="card card-body border-0 bg-white">
                                        <h5>–†–µ–∑—É–ª—å—Ç–∞—Ç:</h5>
                                        <pre style="background: #f4f4f4; padding: 15px; max-height: 400px; overflow-y: auto;">{{ report.review_result }}</pre>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>

                <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
                <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center">
                        {% if page_obj.has_previous %}
                            <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">–ù–∞–∑–∞–¥</a></li>
                        {% endif %}

                        <li class="page-item active"><a class="page-link" href="#">{{ page_obj.number }}</a></li>

                        {% if page_obj.has_next %}
                            <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">–í–ø–µ—Ä–µ–¥</a></li>
                        {% endif %}
                    </ul>
                </nav>
                {% else %}
                    <p class="text-center text-muted">–û—Ç—á–µ—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–¥ –Ω–∞ localhost:8000</p>
                {% endif %}
            </div>
        </div>

        <div class="text-center mt-3">
            <a href="/admin/" class="btn btn-secondary">–í –ê–¥–º–∏–Ω–∫—É</a>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>